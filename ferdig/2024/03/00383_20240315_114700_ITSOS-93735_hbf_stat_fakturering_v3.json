{
  "navn": "Rutine for kjøring av pa_ork_ba_01 for HBF STAT fakturering for termin ${termin} med grunnlagsdataMappe ${grunnlagsdataMappe}",
  "gyldigVersjon": "0.0.78",
  "variabler": {
    "grunnlagsdataMappe": "grunnlagsdata_2024-03-15_11-40-11-18",

    "termin": "2024-01",
    "førstePeriode": "202311",
    "andrePeriode": "202312",
    "tredjePeriode": "202401",
    "fjerdePeriode": "202402",

    "termininfoVersjon": "2024/v1",
    "premiejusteringVersjon": "10048_10049_10050_10051",

    "paFakBa04Versjon": "3.0.0",
    "paFakBa09Versjon": "3.0.0",
    "paFakBa14Versjon": "1.0.14"
  },
  "operasjoner": [
    {
      "handling": "deploy_batch",
      "batcher": [
        {
          "navn": "pa_fak_ba_04",
          "versjon": "${paFakBa04Versjon}"
        },
        {
          "navn": "pa_fak_ba_09",
          "versjon": "${paFakBa09Versjon}"
        },
        {
          "navn": "pa_fak_ba_14",
          "versjon": "${paFakBa14Versjon}"
        }
      ]
    },
    {
      "navn": "pa_fak_ba_14 premiefiltrering for hbf stat ${førstePeriode}",
      "handling": "gruppe",
      "gruppeAv": [
        {
          "handling": "rydd_grunnlagsdata_for_batch",
          "batch": "pa_fak_ba_14"
        },
        {
          "handling": "kopier_filer_fra_aktuar_til_batch",
          "premiemodell": "hbf_stat",
          "periode": "${førstePeriode}",
          "prognoseVersjon": "avtaleliste",
          "batch": "pa_fak_ba_14",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "filnavn": "avtaleliste_hbf_stat"
        },
        {
          "handling": "kopier_fra_arkiv_til_batch",
          "filnavn": "fakturerbare_premiedifferanser",
          "batchFra": "pa_fak_ba_13",
          "batchTil": "pa_fak_ba_14",
          "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
          "nøkkel": "generer_fakturerbare_premiedifferanser/${førstePeriode}"
        },
        {
          "handling": "pa_fak_ba_14",
          "modus": "premiefiltrering_for_hbf_stat",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "validerFeilendeMedlemmer": true
        },
        {
          "handling": "arkiver_all_batch_output",
          "batch": "pa_fak_ba_14",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "nøkkel": "premiefiltrering_for_hbf_stat/${førstePeriode}"
        },
        {
          "handling": "rydd_grunnlagsdata_for_batch",
          "batch": "pa_fak_ba_14"
        }
      ]
    },
    {
      "navn": "pa_fak_ba_14 premiefiltrering for hbf stat ${andrePeriode}",
      "handling": "gruppe",
      "gruppeAv": [
        {
          "handling": "kopier_filer_fra_aktuar_til_batch",
          "premiemodell": "hbf_stat",
          "periode": "${andrePeriode}",
          "prognoseVersjon": "avtaleliste",
          "batch": "pa_fak_ba_14",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "filnavn": "avtaleliste_hbf_stat"
        },
        {
          "handling": "kopier_fra_arkiv_til_batch",
          "filnavn": "fakturerbare_premiedifferanser",
          "batchFra": "pa_fak_ba_13",
          "batchTil": "pa_fak_ba_14",
          "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
          "nøkkel": "generer_fakturerbare_premiedifferanser/${andrePeriode}"
        },
        {
          "handling": "pa_fak_ba_14",
          "modus": "premiefiltrering_for_hbf_stat",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "validerFeilendeMedlemmer": true
        },
        {
          "handling": "arkiver_all_batch_output",
          "batch": "pa_fak_ba_14",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "nøkkel": "premiefiltrering_for_hbf_stat/${andrePeriode}"
        },
        {
          "handling": "rydd_grunnlagsdata_for_batch",
          "batch": "pa_fak_ba_14"
        }
      ]
    },
    {
      "navn": "pa_fak_ba_14 premiefiltrering for hbf stat ${tredjePeriode}",
      "handling": "gruppe",
      "gruppeAv": [
        {
          "handling": "kopier_filer_fra_aktuar_til_batch",
          "premiemodell": "hbf_stat",
          "periode": "${tredjePeriode}",
          "prognoseVersjon": "avtaleliste",
          "batch": "pa_fak_ba_14",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "filnavn": "avtaleliste_hbf_stat"
        },
        {
          "handling": "kopier_fra_arkiv_til_batch",
          "filnavn": "fakturerbare_premiedifferanser",
          "batchFra": "pa_fak_ba_13",
          "batchTil": "pa_fak_ba_14",
          "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
          "nøkkel": "generer_fakturerbare_premiedifferanser/${tredjePeriode}",
          "feilHvisFilMangler": false
        },
        {
          "handling": "pa_fak_ba_14",
          "modus": "premiefiltrering_for_hbf_stat",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "validerFeilendeMedlemmer": true
        },
        {
          "handling": "arkiver_all_batch_output",
          "batch": "pa_fak_ba_14",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "nøkkel": "premiefiltrering_for_hbf_stat/${tredjePeriode}"
        },
        {
          "handling": "rydd_grunnlagsdata_for_batch",
          "batch": "pa_fak_ba_14"
        }
      ]
    },
    {
      "navn": "pa_fak_ba_14 premiefiltrering for hbf stat ${fjerdePeriode}",
      "handling": "gruppe",
      "gruppeAv": [
        {
          "handling": "kopier_filer_fra_aktuar_til_batch",
          "premiemodell": "hbf_stat",
          "periode": "${fjerdePeriode}",
          "prognoseVersjon": "avtaleliste",
          "batch": "pa_fak_ba_14",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "filnavn": "avtaleliste_hbf_stat"
        },
        {
          "handling": "kopier_fra_arkiv_til_batch",
          "filnavn": "fakturerbare_premiedifferanser",
          "batchFra": "pa_fak_ba_13",
          "batchTil": "pa_fak_ba_14",
          "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
          "nøkkel": "generer_fakturerbare_premiedifferanser/${fjerdePeriode}"
        },
        {
          "handling": "pa_fak_ba_14",
          "modus": "premiefiltrering_for_hbf_stat",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "validerFeilendeMedlemmer": true
        },
        {
          "handling": "arkiver_all_batch_output",
          "batch": "pa_fak_ba_14",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "nøkkel": "premiefiltrering_for_hbf_stat/${fjerdePeriode}"
        },
        {
          "handling": "rydd_grunnlagsdata_for_batch",
          "batch": "pa_fak_ba_14"
        }
      ]
    },
    {
      "navn": "pa_fak_ba_04 generer hbf stat fakturaunderlag og agressofil ${termin}",
      "handling": "gruppe",
      "gruppeAv": [
        {
          "handling": "rydd_grunnlagsdata_for_batch",
          "batch": "pa_fak_ba_04"
        },
        {
          "handling": "kopier_termininfofil_fra_arkiv_til_batch",
          "batchTil": "pa_fak_ba_04",
          "termininfoVersjon": "${termininfoVersjon}",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}"
        },
        {
          "handling": "kopier_filer_fra_aktuar_til_batch",
          "premiemodell": "hbf_stat",
          "periode": "${termin}",
          "prognoseVersjon": "${premiejusteringVersjon}",
          "batch": "pa_fak_ba_04",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "tillatTomFil": true
        },
        {
          "navn": "pa_fak_ba_04 ${førstePeriode}",
          "handling": "gruppe",
          "gruppeAv": [
            {
              "handling": "konkatiner_og_kopier_fil_fra_aktuar_til_batch",
              "premiemodell": "hbf_stat",
              "periode": "${førstePeriode}",
              "prognoseVersjon": "avtaleliste",
              "batch": "pa_fak_ba_04",
              "grunnlagsdataMappe": "${grunnlagsdataMappe}",
              "filnavn": "avtaleliste_hbf_stat"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "reservetransaksjonsdifferanser_medlem",
              "batchFra": "pa_fak_ba_14",
              "batchTil": "pa_fak_ba_04",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "premiefiltrering_for_hbf_stat/${førstePeriode}"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "administrasjonspremie",
              "batchFra": "pa_fak_ba_05",
              "batchTil": "pa_fak_ba_04",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "generer_administrasjonspremier/${førstePeriode}"
            }
          ]
        },
        {
          "navn": "pa_fak_ba_04 ${andrePeriode}",
          "handling": "gruppe",
          "gruppeAv": [
            {
              "handling": "konkatiner_og_kopier_fil_fra_aktuar_til_batch",
              "premiemodell": "hbf_stat",
              "periode": "${andrePeriode}",
              "prognoseVersjon": "avtaleliste",
              "batch": "pa_fak_ba_04",
              "grunnlagsdataMappe": "${grunnlagsdataMappe}",
              "filnavn": "avtaleliste_hbf_stat"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "reservetransaksjonsdifferanser_medlem",
              "batchFra": "pa_fak_ba_14",
              "batchTil": "pa_fak_ba_04",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "premiefiltrering_for_hbf_stat/${andrePeriode}"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "administrasjonspremie",
              "batchFra": "pa_fak_ba_05",
              "batchTil": "pa_fak_ba_04",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "generer_administrasjonspremier/${andrePeriode}"
            }
          ]
        },
        {
          "navn": "pa_fak_ba_04 ${tredjePeriode}",
          "handling": "gruppe",
          "gruppeAv": [
            {
              "handling": "konkatiner_og_kopier_fil_fra_aktuar_til_batch",
              "premiemodell": "hbf_stat",
              "periode": "${tredjePeriode}",
              "prognoseVersjon": "avtaleliste",
              "batch": "pa_fak_ba_04",
              "grunnlagsdataMappe": "${grunnlagsdataMappe}",
              "filnavn": "avtaleliste_hbf_stat"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "reservetransaksjonsdifferanser_medlem",
              "batchFra": "pa_fak_ba_14",
              "batchTil": "pa_fak_ba_04",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "premiefiltrering_for_hbf_stat/${tredjePeriode}"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "administrasjonspremie",
              "batchFra": "pa_fak_ba_05",
              "batchTil": "pa_fak_ba_04",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "generer_administrasjonspremier/${tredjePeriode}"
            }
          ]
        },
        {
          "navn": "pa_fak_ba_04 ${fjerdePeriode}",
          "handling": "gruppe",
          "gruppeAv": [
            {
              "handling": "konkatiner_og_kopier_fil_fra_aktuar_til_batch",
              "premiemodell": "hbf_stat",
              "periode": "${fjerdePeriode}",
              "prognoseVersjon": "avtaleliste",
              "batch": "pa_fak_ba_04",
              "grunnlagsdataMappe": "${grunnlagsdataMappe}",
              "filnavn": "avtaleliste_hbf_stat"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "reservetransaksjonsdifferanser_medlem",
              "batchFra": "pa_fak_ba_14",
              "batchTil": "pa_fak_ba_04",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "premiefiltrering_for_hbf_stat/${fjerdePeriode}"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "administrasjonspremie",
              "batchFra": "pa_fak_ba_05",
              "batchTil": "pa_fak_ba_04",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "generer_administrasjonspremier/${fjerdePeriode}"
            }
          ]
        },
        {
          "handling": "pa_fak_ba_04",
          "modus": "generer_fakturaunderlag_for_hbf_stat",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "termin": "${termin}",
          "premiemodell": "HBF_STAT",
          "validerFeilendeMedlemmer": true
        },
        {
          "handling": "arkiver_batch_output",
          "filnavn": "fakturaunderlag",
          "batch": "pa_fak_ba_04",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "nøkkel": "generer_fakturaunderlag_for_hbf_stat/${termin}"
        },
        {
          "handling": "pa_fak_ba_04",
          "modus": "generer_agressofil_for_hbf_stat",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "termin": "${termin}",
          "premiemodell": "HBF_STAT",
          "validerFeilendeMedlemmer": true
        },
        {
          "handling": "arkiver_all_batch_output",
          "batch": "pa_fak_ba_04",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "nøkkel": "generer_agressofil_for_hbf_stat/${termin}",
          "filter": "Agressofil"
        },
        {
          "handling": "rydd_grunnlagsdata_for_batch",
          "batch": "pa_fak_ba_04"
        }
      ]
    },
    {
      "navn": "pa_fak_ba_09 generer hbf stat dataunderlag avtale og medlem ${termin}",
      "handling": "gruppe",
      "gruppeAv": [
        {
          "handling": "rydd_grunnlagsdata_for_batch",
          "batch": "pa_fak_ba_09"
        },
        {
          "handling": "kopier_termininfofil_fra_arkiv_til_batch",
          "batchTil": "pa_fak_ba_09",
          "termininfoVersjon": "${termininfoVersjon}",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}"
        },
        {
          "handling": "kopier_filer_fra_aktuar_til_batch",
          "premiemodell": "hbf_stat",
          "periode": "${termin}",
          "prognoseVersjon": "${premiejusteringVersjon}",
          "batch": "pa_fak_ba_09",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "tillatTomFil": true
        },
        {
          "navn": "pa_fak_ba_09 ${førstePeriode}",
          "handling": "gruppe",
          "gruppeAv": [
            {
              "handling": "konkatiner_og_kopier_fil_fra_aktuar_til_batch",
              "premiemodell": "hbf_stat",
              "periode": "${førstePeriode}",
              "prognoseVersjon": "avtaleliste",
              "batch": "pa_fak_ba_09",
              "grunnlagsdataMappe": "${grunnlagsdataMappe}",
              "filnavn": "avtaleliste_hbf_stat"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "reservetransaksjonsdifferanser_medlem",
              "batchFra": "pa_fak_ba_14",
              "batchTil": "pa_fak_ba_09",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "premiefiltrering_for_hbf_stat/${førstePeriode}"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "administrasjonspremie",
              "batchFra": "pa_fak_ba_05",
              "batchTil": "pa_fak_ba_09",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "generer_administrasjonspremier/${førstePeriode}"
            }
          ]
        },
        {
          "navn": "pa_fak_ba_09 ${andrePeriode}",
          "handling": "gruppe",
          "gruppeAv": [
            {
              "handling": "konkatiner_og_kopier_fil_fra_aktuar_til_batch",
              "premiemodell": "hbf_stat",
              "periode": "${andrePeriode}",
              "prognoseVersjon": "avtaleliste",
              "batch": "pa_fak_ba_09",
              "grunnlagsdataMappe": "${grunnlagsdataMappe}",
              "filnavn": "avtaleliste_hbf_stat"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "reservetransaksjonsdifferanser_medlem",
              "batchFra": "pa_fak_ba_14",
              "batchTil": "pa_fak_ba_09",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "premiefiltrering_for_hbf_stat/${andrePeriode}"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "administrasjonspremie",
              "batchFra": "pa_fak_ba_05",
              "batchTil": "pa_fak_ba_09",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "generer_administrasjonspremier/${andrePeriode}"
            }
          ]
        },
        {
          "navn": "pa_fak_ba_09 ${tredjePeriode}",
          "handling": "gruppe",
          "gruppeAv": [
            {
              "handling": "konkatiner_og_kopier_fil_fra_aktuar_til_batch",
              "premiemodell": "hbf_stat",
              "periode": "${tredjePeriode}",
              "prognoseVersjon": "avtaleliste",
              "batch": "pa_fak_ba_09",
              "grunnlagsdataMappe": "${grunnlagsdataMappe}",
              "filnavn": "avtaleliste_hbf_stat"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "reservetransaksjonsdifferanser_medlem",
              "batchFra": "pa_fak_ba_14",
              "batchTil": "pa_fak_ba_09",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "premiefiltrering_for_hbf_stat/${tredjePeriode}"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "administrasjonspremie",
              "batchFra": "pa_fak_ba_05",
              "batchTil": "pa_fak_ba_09",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "generer_administrasjonspremier/${tredjePeriode}"
            }
          ]
        },
        {
          "navn": "pa_fak_ba_09 ${fjerdePeriode}",
          "handling": "gruppe",
          "gruppeAv": [
            {
              "handling": "konkatiner_og_kopier_fil_fra_aktuar_til_batch",
              "premiemodell": "hbf_stat",
              "periode": "${fjerdePeriode}",
              "prognoseVersjon": "avtaleliste",
              "batch": "pa_fak_ba_09",
              "grunnlagsdataMappe": "${grunnlagsdataMappe}",
              "filnavn": "avtaleliste_hbf_stat"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "reservetransaksjonsdifferanser_medlem",
              "batchFra": "pa_fak_ba_14",
              "batchTil": "pa_fak_ba_09",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "premiefiltrering_for_hbf_stat/${fjerdePeriode}"
            },
            {
              "handling": "kopier_fra_arkiv_til_batch",
              "filnavn": "administrasjonspremie",
              "batchFra": "pa_fak_ba_05",
              "batchTil": "pa_fak_ba_09",
              "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
              "nøkkel": "generer_administrasjonspremier/${fjerdePeriode}"
            }
          ]
        },
        {
          "handling": "pa_fak_ba_09",
          "modus": "hbf_stat_dataunderlag_for_medlem",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "premiemodell": "HBF_STAT",
          "termin": "${termin}",
          "kjøringsId": "0b1e2d3d-8cf8-41d0-a1e8-ee57a0b40892",
          "validerFeilendeMedlemmer": true
        },
        {
          "handling": "arkiver_all_batch_output",
          "batch": "pa_fak_ba_09",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "nøkkel": "hbf_stat_dataunderlag_for_medlem/${termin}"
        },
        {
          "handling": "send_batch_output_til_dvh",
          "filPrefix": "hbf_stat_dataunderlag_medlem",
          "filListe": "HBFSTAT_FILLISTE_MEDLEM.txt",
          "batch": "pa_fak_ba_09",
          "filstiHosDVH": "/hbf_stat/fakturering/medlem"
        },
        {
          "handling": "pa_fak_ba_09",
          "modus": "hbf_stat_dataunderlag_for_avtale",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "premiemodell": "HBF_STAT",
          "termin": "${termin}",
          "kjøringsId": "dace1537-4d2c-411d-ace7-b9d63b9770b2",
          "validerFeilendeMedlemmer": true
        },
        {
          "handling": "arkiver_all_batch_output",
          "batch": "pa_fak_ba_09",
          "grunnlagsdataMappe": "${grunnlagsdataMappe}",
          "nøkkel": "hbf_stat_dataunderlag_for_avtale/${termin}"
        },
        {
          "handling": "send_batch_output_til_dvh",
          "filPrefix": "hbf_stat_dataunderlag_avtale",
          "filListe": "HBFSTAT_FILLISTE_AVTALE.txt",
          "batch": "pa_fak_ba_09",
          "filstiHosDVH": "/hbf_stat/fakturering/avtale"
        },
        {
          "handling": "rydd_grunnlagsdata_for_batch",
          "batch": "pa_fak_ba_09"
        }
      ]
    }
  ]
}
