{
  "navn": "Rutine for kjøring av pa_ork_ba_01 for månedlig analyseunderlag og premiedifferanser med grunnlagsdataMappe ${grunnlagsdataMappe} for periode ${periode}",
  "gyldigVersjon": "0.0.60",
  "variabler": {
    "grunnlagsdataMappe" : "#{grunnlagsdatamappeNå}",
    "grunnlagsdataFremskriving": "grunnlagsdata_2022-12-31_17-08-07-50",
    "reserveberegningGrunnlagsdataAktuarVersjon": "5",
    "paResBa01Versjon": "1.2.55",
    "fremskrivingsDato" : "2023.01.01",
    "forrigeFremskrivingsDato": "2022.12.01",
    "periode":"202212",
    "rettighet": "panda_veldig_forenkla_rettighet",
    "uttrekksdato": "31.12.2022"
  },

  "operasjoner": [
    {
      "handling": "deploy_batch",
      "batcher": [
        {
          "navn": "pa_res_ba_01",
          "versjon": "${paResBa01Versjon}"
        },
        {
          "navn": "pa_fak_ba_02",
          "versjon": "1.0.1"
        },
        {
          "navn": "pa_fak_ba_03",
          "versjon": "1.0.1"
        },
        {
          "navn": "pa_fak_ba_05",
          "versjon": "1.0.0"
        },
        {
          "navn": "pa_fak_ba_09",
          "versjon": "1.0.10"
        },
        {
          "navn": "pa_fak_ba_11",
          "versjon": "1.0.3"
        },
        {
          "navn": "pa_fak_ba_12",
          "versjon": "1.0.0"
        },
        {
          "navn": "pa_fak_ba_13",
          "versjon": "1.0.1"
        }
      ]
    },
    {
      "ignorertInstruksjon": true,
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_res_ba_01",
      "grunnlagsdataMappe": "${grunnlagsdataFremskriving}"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "kopier_arkivert_pa_res_ba_02_til_pa_res_ba_01",
      "fraGrunnlagsdataMappe": "${grunnlagsdataFremskriving}",
      "tilGrunnlagsdataMappe": "${grunnlagsdataFremskriving}"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "kopier_arkivert_grunnlagsdata_fra_aktuar_til_pa_res_ba_01",
      "versjon": "${reserveberegningGrunnlagsdataAktuarVersjon}",
      "tilGrunnlagsdataMappe": "${grunnlagsdataFremskriving}"
    },


    {
      "ignorertInstruksjon": true,
      "handling": "pa_res_ba_01",
      "modus": "panda_reserveberegning",
      "sisteFremskrivingsdato": "${fremskrivingsDato}",
      "grunnlagsdataMappe": "${grunnlagsdataFremskriving}",
      "rettighet": "${rettighet}"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "arkiver_all_batch_output",
      "batch": "pa_res_ba_01",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "panda_reserveberegning/${fremskrivingsDato}"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "pa_res_ba_01",
      "modus": "panda_administrasjonspremieunderlag",
      "sisteFremskrivingsdato": "${fremskrivingsDato}",
      "grunnlagsdataMappe": "${grunnlagsdataFremskriving}",
      "rettighet": "${rettighet}"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "arkiver_all_batch_output",
      "batch": "pa_res_ba_01",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "panda_administrasjonspremieunderlag/${fremskrivingsDato}"
    },

    {
      "ignorertInstruksjon": true,
      "handling": "pa_res_ba_01",
      "modus": "panda-testdata-rettighet-ytelser",
      "grunnlagsdataMappe": "${grunnlagsdataFremskriving}",
      "sisteFremskrivingsdato": "${fremskrivingsDato}",
      "rettighet": "${rettighet}"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "send_batch_output_til_dvh",
      "filPrefix": "rettighet_ytelser_for_dvh",
      "filListe": "RETTIGHET_YTELSE_FILLISTE.txt",
      "batch": "pa_res_ba_01",
      "encoding": "utf-16le",
      "filstiHosDVH": "/rettighet_ytelse"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "arkiver_all_batch_output",
      "batch": "pa_res_ba_01",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "panda-testdata-rettighet-ytelser/${fremskrivingsDato}"
    },


    {
      "ignorertInstruksjon": true,
      "handling": "pa_res_ba_01",
      "modus": "panda-poliser",
      "sisteFremskrivingsdato": "${fremskrivingsDato}",
      "grunnlagsdataMappe": "${grunnlagsdataFremskriving}"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "send_batch_output_til_dvh",
      "filPrefix": "poliser",
      "filListe": "POLISE_FILLISTE.txt",
      "batch": "pa_res_ba_01",
      "encoding": "utf-16le",
      "filstiHosDVH": "/polise"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "arkiver_all_batch_output",
      "batch": "pa_res_ba_01",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "panda-poliser/${fremskrivingsDato}"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_res_ba_01",
      "grunnlagsdataMappe": "${grunnlagsdataFremskriving}"
    },

    {
      "ignorertInstruksjon": true,
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "administrasjonspremieunderlag",
      "batchFra": "pa_res_ba_01",
      "batchTil": "pa_fak_ba_09",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "panda_administrasjonspremieunderlag/${fremskrivingsDato}"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "pa_fak_ba_09",
      "modus": "generer_administrasjonspremieunderlag_dataunderlag",
      "kjøringsId": "#{genererUUID}",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "bokføringsperiode":"${periode}",
      "validerFeilendeMedlemmer": true
    },
    {
      "ignorertInstruksjon": true,
      "handling": "arkiver_all_batch_output",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "generer_administrasjonspremieunderlag_dataunderlag/${fremskrivingsDato}"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "send_batch_output_til_dvh",
      "filPrefix": "administrasjonspremieunderlag_dataunderlag",
      "filListe": "ADMINISTRASJONSPREMIEUNDERLAG_FILLISTE.txt",
      "batch": "pa_fak_ba_09",
      "filstiHosDVH": "/administrasjonspremieunderlag"
    },

    {
      "ignorertInstruksjon": true,
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "feilmeldinger",
      "batchFra": "pa_res_ba_01",
      "batchTil": "pa_fak_ba_09",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "panda_reserveberegning/${fremskrivingsDato}"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "pa_fak_ba_09",
      "modus": "feilmelding_dataunderlag",
      "kjøringsId": "#{genererUUID}",
      "uttrekksdato": "${uttrekksdato}",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "bokføringsperiode":"${periode}",
      "validerFeilendeMedlemmer": true
    },
    {
      "ignorertInstruksjon": true,
      "handling": "arkiver_all_batch_output",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "feilmelding_dataunderlag/${fremskrivingsDato}"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "send_batch_output_til_dvh",
      "filPrefix": "feilmelding_dataunderlag",
      "filListe": "FEILENDE_MEDLEM_FILLISTE.txt",
      "batch": "pa_fak_ba_09",
      "filstiHosDVH": "/feilende_medlemmer"
    },
    {
      "ignorertInstruksjon": true,
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },


    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_11",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "kontofoering",
      "batchFra": "pa_res_ba_01",
      "batchTil": "pa_fak_ba_11",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "panda_reserveberegning/${fremskrivingsDato}",
      "kommentar": "Henter fra siste grunnlagsdatamappe"
    },
    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "feilmeldinger",
      "batchFra": "pa_res_ba_01",
      "batchTil": "pa_fak_ba_11",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "panda_reserveberegning/${fremskrivingsDato}",
      "kommentar": "Henter fra siste grunnlagsdatamappe"
    },
    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "flettede_kontofoeringer",
      "batchFra": "pa_fak_ba_11",
      "batchTil": "pa_fak_ba_11",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "flette_feilende_medlemmer/${forrigeFremskrivingsDato}",
      "kommentar": "Henter fra siste grunnlagsdatamappe"
    },
    {
      "handling": "hent_spesifisert_del_av_medlemsdata",
      "batchTil": "pa_fak_ba_11",
      "filnavnTil": "etterlatte",
      "typeindikator": "ETTERLATT",
      "grunnlagsdataMappeFra": "${grunnlagsdataFremskriving}",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}"
    },
    {
      "handling": "pa_fak_ba_11",
      "modus": "flette_feilende_medlemmer_med_filtrering",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "reserveberegningVersjon": "${paResBa01Versjon}",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_all_batch_output",
      "batch": "pa_fak_ba_11",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "flette_feilende_medlemmer/${fremskrivingsDato}"
    },
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_11",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },


    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_03",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "flettede_kontofoeringer",
      "batchFra": "pa_fak_ba_11",
      "batchTil": "pa_fak_ba_03",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "flette_feilende_medlemmer/${forrigeFremskrivingsDato}",
      "kommentar": "Henter fra siste grunnlagsdatamappe"
    },
    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "flettede_kontofoeringer",
      "batchFra": "pa_fak_ba_11",
      "batchTil": "pa_fak_ba_03",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "flette_feilende_medlemmer/${fremskrivingsDato}",
      "kommentar": "Henter fra siste grunnlagsdatamappe"
    },
    {
      "handling": "pa_fak_ba_03",
      "modus": "reserveoppbygging",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "førsteKjøring": "${forrigeFremskrivingsDato}",
      "andreKjøring": "${fremskrivingsDato}",
      "bokføringsperiode": "${periode}",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_all_batch_output",
      "batch": "pa_fak_ba_03",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "reserveoppbygging/${periode}"
    },
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_03",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },


    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "reserveoppbygging",
      "batchFra": "pa_fak_ba_03",
      "batchTil": "pa_fak_ba_09",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "reserveoppbygging/${periode}"
    },
    {
      "handling": "pa_fak_ba_09",
      "modus": "generer_reserveoppbygging_dataunderlag",
      "kjøringsId": "#{genererUUID}",
      "uttrekksdato": "${uttrekksdato}",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_all_batch_output",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "generer_reserveoppbygging_dataunderlag/${periode}"
    },
    {
      "handling": "send_batch_output_til_dvh",
      "filPrefix": "reserveoppbygging_dataunderlag",
      "filListe": "RESERVEOPPBYGGING_FILLISTE.txt",
      "batch": "pa_fak_ba_09",
      "filstiHosDVH": "/reserveoppbygging",
      "encoding": "UTF-16LE"
    },
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },

    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "flettede_kontofoeringer",
      "batchFra": "pa_fak_ba_11",
      "batchTil": "pa_fak_ba_09",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "flette_feilende_medlemmer/${fremskrivingsDato}",
      "kommentar": "Henter fra siste grunnlagsdatamappe"
    },
    {
      "handling": "pa_fak_ba_09",
      "modus": "generer_kontofoeringunderlag",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "uttrekksdato": "${uttrekksdato}",
      "kjøringsId": "#{genererUUID}",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_all_batch_output",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "generer_kontofoeringunderlag/${fremskrivingsDato}"
    },
    {
      "handling": "send_batch_output_til_dvh",
      "filPrefix": "kontofoeringunderlag",
      "filListe": "KONTOFOERING_FILLISTE.txt",
      "batch": "pa_fak_ba_09",
      "filstiHosDVH": "/kontofoering",
      "encoding": "UTF-16LE"
    },
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },


    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_13",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "reserveoppbygging",
      "batchFra": "pa_fak_ba_03",
      "batchTil": "pa_fak_ba_13",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "reserveoppbygging/${periode}"
    },
    {
      "handling": "pa_fak_ba_13",
      "modus": "generer_fakturerbare_premiedifferanser",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_all_batch_output",
      "batch": "pa_fak_ba_13",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "generer_fakturerbare_premiedifferanser/${periode}"
    },


    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_02",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "flettede_kontofoeringer",
      "batchFra": "pa_fak_ba_11",
      "batchTil": "pa_fak_ba_02",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "flette_feilende_medlemmer/${fremskrivingsDato}",
      "kommentar": "Henter fra siste grunnlagsdatamappe"
    },
    {
      "handling": "pa_fak_ba_02",
      "modus": "reserveaggregering_for_medlem",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_all_batch_output",
      "batch": "pa_fak_ba_02",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "reserveaggregering_for_medlem/${fremskrivingsDato}"
    },
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_02",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },



    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "totalreserver",
      "batchFra": "pa_fak_ba_02",
      "batchTil": "pa_fak_ba_12",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "reserveaggregering_for_medlem/${fremskrivingsDato}"
    },
    {
      "handling": "pa_fak_ba_12",
      "modus": "aggreger_csv",
      "filnavn": "totalreserver",
      "utFilnavn": "totalreserve",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "resultatfelter": "5"
    },
    {
      "handling": "arkiver_all_batch_output",
      "batch": "pa_fak_ba_12",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "pa_fak_ba_02/reserveaggregering_for_medlem/${fremskrivingsDato}"
    },


    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_05",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "administrasjonspremieunderlag",
      "batchFra": "pa_res_ba_01",
      "batchTil": "pa_fak_ba_05",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "panda_administrasjonspremieunderlag/${fremskrivingsDato}",
      "kommentar": "Henter fra siste grunnlagsdatamappe"
    },
    {
      "handling": "pa_fak_ba_05",
      "modus": "generer_administrasjonspremier",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "bokføringsperiode": "${periode}",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_all_batch_output",
      "batch": "pa_fak_ba_05",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "generer_administrasjonspremier/${periode}"
    },
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_05",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },

    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "administrasjonspremie",
      "batchFra": "pa_fak_ba_05",
      "batchTil": "pa_fak_ba_09",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "generer_administrasjonspremier/${periode}"
    },
    {
      "handling": "pa_fak_ba_09",
      "modus": "generer_administrasjonspremie_dataunderlag",
      "kjøringsId": "#{genererUUID}",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_all_batch_output",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "generer_administrasjonspremie_dataunderlag/${periode}"
    },
    {
      "handling": "send_batch_output_til_dvh",
      "filPrefix": "administrasjonspremie_dataunderlag",
      "filListe": "ADMINISTRASJONSPREMIE_FILLISTE.txt",
      "batch": "pa_fak_ba_09",
      "filstiHosDVH": "/administrasjonspremie"
    },
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    }
  ]
}