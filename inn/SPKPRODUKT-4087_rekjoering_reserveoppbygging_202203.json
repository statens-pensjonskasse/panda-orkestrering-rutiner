{
  "navn": "Rutine for kjøring av pa_ork_ba_01 for rekjøring av reserveoppbygging med gammel versjon ${paFakBa03GammelVersjon} og grunnlagsdataMappe ${grunnlagsdataMappe} for periode ${periode}",
  "gyldigVersjon": "0.0.60",
  "variabler": {
    "grunnlagsdataMappe" : "#{grunnlagsdatamappeNå}",
    "paFakBa03GammelVersjon": "0.0.44",
    "paFakBa03NyesteVersjon": "0.0.45",
    "fremskrivingsDato" : "2022.04.01",
    "forrigeFremskrivingsDato": "2022.03.01",
    "periode":"202203",
    "uttrekksdato": "31.03.2022"
  },

  "operasjoner": [
    {
      "handling": "deploy_batch",
      "batcher": [
        {
          "navn": "pa_fak_ba_03",
          "versjon": "${paFakBa03GammelVersjon}"
        }
      ]
    },
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_03",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "flettede_kontofoeringer",
      "batchFra": "pa_fak_ba_11",
      "batchTil": "pa_fak_ba_03",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "flette_feilende_medlemmer/${forrigeFremskrivingsDato}",
      "kommentar": "Henter fra siste grunnlagsdatamappe"
    },
    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "flettede_kontofoeringer",
      "batchFra": "pa_fak_ba_11",
      "batchTil": "pa_fak_ba_03",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "flette_feilende_medlemmer/${fremskrivingsDato}",
      "kommentar": "Henter fra siste grunnlagsdatamappe"
    },
    {
      "handling": "pa_fak_ba_03",
      "modus": "reserveoppbygging",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "førsteKjøring": "${forrigeFremskrivingsDato}",
      "andreKjøring": "${fremskrivingsDato}",
      "bokføringsperiode": "${periode}",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_all_batch_output",
      "batch": "pa_fak_ba_03",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "reserveoppbygging/${periode}"
    },
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_03",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },


    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "handling": "kopier_fra_arkiv_til_batch",
      "filnavn": "reserveoppbygging",
      "batchFra": "pa_fak_ba_03",
      "batchTil": "pa_fak_ba_09",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "reserveoppbygging/${periode}"
    },
    {
      "handling": "pa_fak_ba_09",
      "modus": "generer_reserveoppbygging_dataunderlag",
      "kjøringsId": "#{genererUUID}",
      "uttrekksdato": "${uttrekksdato}",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_all_batch_output",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "generer_reserveoppbygging_dataunderlag/${periode}"
    },
    {
      "handling": "send_batch_output_til_dvh",
      "filPrefix": "reserveoppbygging_dataunderlag",
      "filListe": "RESERVEOPPBYGGING_FILLISTE.txt",
      "batch": "pa_fak_ba_09",
      "filstiHosDVH": "/reserveoppbygging/${periode}",
      "encoding": "UTF-16LE"
    },
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "handling": "deploy_batch",
      "batcher": [
        {
          "navn": "pa_fak_ba_03",
          "versjon": "${paFakBa03NyesteVersjon}"
        }
      ]
    }
  ]
}
