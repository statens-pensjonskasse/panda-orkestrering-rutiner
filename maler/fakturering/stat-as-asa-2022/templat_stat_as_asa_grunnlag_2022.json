{
  "navn": "Rutine for kjøring av fast månedlig grunnlagsrutine for fremskriving ${fremskrivingsDato} for STAT / AS_ASA",
  "gyldigVersjon": "0.0.46",
  "variabler": {
    "grunnlagsdatamappeNå" : "#{grunnlagsdatamappeNå}",
    "reserveberegningGrunnlagsdataAktuarVersjon" : "4",
    "rettighet": "panda_veldig_forenkla_rettighet",

    "bokføringsperiode": "<YYYYMM>",
    "fremskrivingsDato": "<YYYY.MM.DD>",
    "grunnlagsdataFremskriving": "<grunnlagsdata_YYYY-MM-DD_HH-mm-ss>"
  },
  "operasjoner": [
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_res_ba_01",
      "grunnlagsdataMappe": "${grunnlagsdataFremskriving}"
    },
    {
      "handling": "kopier_arkivert_pa_res_ba_02_til_pa_res_ba_01",
      "fraGrunnlagsdataMappe": "${grunnlagsdataFremskriving}",
      "tilGrunnlagsdataMappe": "${grunnlagsdataFremskriving}"
    },
    {
      "handling": "kopier_arkivert_grunnlagsdata_fra_aktuar_til_pa_res_ba_01",
      "versjon": "${reserveberegningGrunnlagsdataAktuarVersjon}",
      "tilGrunnlagsdataMappe": "${grunnlagsdataFremskriving}"
    },


    {
      "handling": "pa_res_ba_01",
      "modus": "panda_reserveberegning",
      "sisteFremskrivingsdato": "${fremskrivingsDato}",
      "grunnlagsdataMappe": "${grunnlagsdataFremskriving}",
      "rettighet": "${rettighet}"
    },
    {
      "handling": "arkiver_batch_output",
      "filnavn": "kontofoering",
      "batch": "pa_res_ba_01",
      "grunnlagsdataMappe": "${grunnlagsdatamappeNå}",
      "nøkkel": "panda_reserveberegning/${fremskrivingsDato}",
      "komprimerOutput": true
    },


    {
      "handling": "pa_res_ba_01",
      "modus": "panda_administrasjonspremieunderlag",
      "sisteFremskrivingsdato": "${fremskrivingsDato}",
      "grunnlagsdataMappe": "${grunnlagsdataFremskriving}",
      "rettighet": "${rettighet}"
    },
    {
      "handling": "arkiver_batch_output",
      "filnavn": "administrasjonspremieunderlag",
      "batch": "pa_res_ba_01",
      "grunnlagsdataMappe": "${grunnlagsdatamappeNå}",
      "nøkkel": "panda_administrasjonspremieunderlag/${fremskrivingsDato}",
      "komprimerOutput": true
    },


    {
      "handling": "pa_res_ba_01",
      "modus": "panda-testdata-rettighet-ytelser",
      "grunnlagsdataMappe": "${grunnlagsdataFremskriving}",
      "sisteFremskrivingsdato": "${fremskrivingsDato}",
      "rettighet": "${rettighet}"
    },
    {
      "handling": "send_batch_output_til_dvh",
      "filPrefix": "testdata_rettighet_og_ytelser",
      "filListe": "RETTIGHET_YTELSE_FILLISTE.txt",
      "batch": "pa_res_ba_01",
      "encoding": "utf-16le",
      "filstiHosDVH": "/rettighet_ytelse/${fremskrivingsDato}"
    },
    {
      "handling": "arkiver_batch_output",
      "filnavn": "testdata_rettighet_og_ytelser",
      "batch": "pa_res_ba_01",
      "grunnlagsdataMappe": "${grunnlagsdatamappeNå}",
      "nøkkel": "panda-testdata-rettighet-ytelser/${fremskrivingsDato}",
      "filter": "KjoeringsId",
      "komprimerOutput": true
    },


    {
      "handling": "pa_res_ba_01",
      "modus": "panda-poliser",
      "sisteFremskrivingsdato": "${fremskrivingsDato}",
      "grunnlagsdataMappe": "${grunnlagsdataFremskriving}"
    },
    {
      "handling": "send_batch_output_til_dvh",
      "filPrefix": "poliser",
      "filListe": "POLISE_FILLISTE.txt",
      "batch": "pa_res_ba_01",
      "encoding": "utf-16le",
      "filstiHosDVH": "/polise/${fremskrivingsDato}"
    },
    {
      "handling": "arkiver_batch_output",
      "filnavn": "poliser",
      "batch": "pa_res_ba_01",
      "grunnlagsdataMappe": "${grunnlagsdatamappeNå}",
      "nøkkel": "panda-poliser/${fremskrivingsDato}",
      "filter": "KjoeringsId",
      "komprimerOutput": true
    },
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_res_ba_01",
      "grunnlagsdataMappe": "${grunnlagsdataFremskriving}"
    },


    {
      "handling": "rydd_filområde_hos_dvh",
      "filstiHosDVH": "/kontofoering/${fremskrivingsDato}"
    },
    {
      "handling": "split_fil_fra_arkiv_til_dvh",
      "filPrefix": "kontofoeringunderlag",
      "batch": "pa_fak_ba_09",
      "modus": "generer_kontofoeringunderlag",
      "periode": "${fremskrivingsDato}",
      "header": "PersonId;Typeindikator;Avtale;PoliseId;Dekning;Hendelsestype;Bevegelsesident;Aksjonsdato;Beloep;Beloep_adm;SisteFremskrivingsdato;Reservetype;Reservehendelsestype;Transaksjonstype;Maalytelse;Utgaaende_tjenestetid;Oppnaaelig_tjenestetid;Polisestatus;SisteKjenteFremskrivingsdato;Feilmelding;SumBelopSnuddFortegn;Md5Sjekksum;Uttrekksdato;UttrekkId;Kjoeringsid;Loepenummer",
      "filstiHosDVH": "/kontofoering/${fremskrivingsDato}",
      "encoding": "utf-16le"
    },
    {
      "handling": "opprett_filliste_og_triggerfil_hos_dvh",
      "filPrefix": "kontofoeringunderlag",
      "filListe": "KONTOFOERING_FILLISTE.txt",
      "filstiHosDVH": "/kontofoering/${fremskrivingsDato}"
    },


    {
      "handling": "rydd_filområde_hos_dvh",
      "filstiHosDVH": "/reserveoppbygging/${bokføringsperiode}"
    },
    {
      "handling": "split_fil_fra_arkiv_til_dvh",
      "filPrefix": "reserveoppbygging_dataunderlag",
      "batch": "pa_fak_ba_09",
      "modus": "generer_reserveoppbygging_dataunderlag",
      "periode": "${bokføringsperiode}",
      "header": "PersonId;Typeindikator;Avtale;PoliseId;Dekning;Hendelsestype;Bevegelsesident;Aksjonsdato;Beloep;Beloep_adm;Bokfoeringsperiode;Reservetype;Reservehendelsestype;Transaksjonstype;Maalytelse;Utgaaende_tjenestetid;Oppnaaelig_tjenestetid;Polisestatus;SumBelopSnuddFortegn;SisteUttrekksdato;UttrekkId;Kjoeringsid",
      "filstiHosDVH": "/reserveoppbygging/${bokføringsperiode}",
      "encoding": "utf-16le"
    },
    {
      "handling": "opprett_filliste_og_triggerfil_hos_dvh",
      "filPrefix": "reserveoppbygging_dataunderlag",
      "filListe": "RESERVEOPPBYGGING_FILLISTE.txt",
      "filstiHosDVH": "/reserveoppbygging/${bokføringsperiode}"
    }
  ]
}
