{
  "navn": "Rutine for kjøring av pa_ork_ba_01 for HBF_FLS sluttfaktura for termin ${termin} og oppgjørsVersjon ${oppgjørsVersjon} med grunnlagsdataMappe ${grunnlagsdataMappe}",
  "gyldigVersjon": "0.0.29",
  "variabler": {
    "grunnlagsdataMappe" : "#{grunnlagsdatamappeNå}",
    "forrigeÅr" : "<YYYY>",
    "inneværendeÅr": "<YYYY>",
    "termin": "<YYYY-TT>",
    "avsluttendeBokføringsperiode" : "<bokføringsperiode>",
    "kjøringsId" : "#{genererUUID}",
    "oppgjørsVersjon": "<oppgjørsVersjon>"
  },

  "operasjoner": [
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_10",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "lopende_premieoppgjoer",
      "batchFra": "pa_fak_ba_07",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil": "${grunnlagsdataMappe}",
      "nøkkel": "beregn_lopende_premieoppgjoer/${forrigeÅr}12"
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "lopende_premieoppgjoer",
      "batchFra": "pa_fak_ba_07",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "beregn_lopende_premieoppgjoer/${inneværendeÅr}01",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "prognosepremieuttrekk",
      "batchFra": "pa_fak_ba_06",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "premiefellesskap_utjevning_prognose/${inneværendeÅr}01",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "lopende_premieoppgjoer",
      "batchFra": "pa_fak_ba_07",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "beregn_lopende_premieoppgjoer/${inneværendeÅr}02",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "prognosepremieuttrekk",
      "batchFra": "pa_fak_ba_06",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "premiefellesskap_utjevning_prognose/${inneværendeÅr}02",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "lopende_premieoppgjoer",
      "batchFra": "pa_fak_ba_07",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "beregn_lopende_premieoppgjoer/${inneværendeÅr}03",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "prognosepremieuttrekk",
      "batchFra": "pa_fak_ba_06",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "premiefellesskap_utjevning_prognose/${inneværendeÅr}03",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "lopende_premieoppgjoer",
      "batchFra": "pa_fak_ba_07",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "beregn_lopende_premieoppgjoer/${inneværendeÅr}04",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "prognosepremieuttrekk",
      "batchFra": "pa_fak_ba_06",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "premiefellesskap_utjevning_prognose/${inneværendeÅr}04",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "lopende_premieoppgjoer",
      "batchFra": "pa_fak_ba_07",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "beregn_lopende_premieoppgjoer/${inneværendeÅr}05",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "prognosepremieuttrekk",
      "batchFra": "pa_fak_ba_06",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "premiefellesskap_utjevning_prognose/${inneværendeÅr}05",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "lopende_premieoppgjoer",
      "batchFra": "pa_fak_ba_07",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "beregn_lopende_premieoppgjoer/${inneværendeÅr}06",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "prognosepremieuttrekk",
      "batchFra": "pa_fak_ba_06",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "premiefellesskap_utjevning_prognose/${inneværendeÅr}06",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "lopende_premieoppgjoer",
      "batchFra": "pa_fak_ba_07",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "beregn_lopende_premieoppgjoer/${inneværendeÅr}07",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "prognosepremieuttrekk",
      "batchFra": "pa_fak_ba_06",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "premiefellesskap_utjevning_prognose/${inneværendeÅr}07",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "lopende_premieoppgjoer",
      "batchFra": "pa_fak_ba_07",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "beregn_lopende_premieoppgjoer/${inneværendeÅr}08",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "prognosepremieuttrekk",
      "batchFra": "pa_fak_ba_06",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "premiefellesskap_utjevning_prognose/${inneværendeÅr}08",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "lopende_premieoppgjoer",
      "batchFra": "pa_fak_ba_07",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "beregn_lopende_premieoppgjoer/${inneværendeÅr}09",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "prognosepremieuttrekk",
      "batchFra": "pa_fak_ba_06",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "premiefellesskap_utjevning_prognose/${inneværendeÅr}09",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "lopende_premieoppgjoer",
      "batchFra": "pa_fak_ba_07",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "beregn_lopende_premieoppgjoer/${inneværendeÅr}10",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "prognosepremieuttrekk",
      "batchFra": "pa_fak_ba_06",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "premiefellesskap_utjevning_prognose/${inneværendeÅr}10",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "lopende_premieoppgjoer",
      "batchFra": "pa_fak_ba_07",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "beregn_lopende_premieoppgjoer/${inneværendeÅr}11",
      "feilHvisFilMangler": false
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "prognosepremieuttrekk",
      "batchFra": "pa_fak_ba_06",
      "batchTil": "pa_fak_ba_10",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "premiefellesskap_utjevning_prognose/${inneværendeÅr}11",
      "feilHvisFilMangler": false
    },
    {
      "handling": "kopier_filer_fra_aktuar_til_batch",
      "premiemodell": "hbf_fls",
      "prognoseVersjon": "${oppgjørsVersjon}",
      "periode": "${avsluttendeBokføringsperiode}",
      "batch": "pa_fak_ba_10",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "kommentar" : "kopierer oppgjoersfil"
    },
    {
      "handling": "pa_fak_ba_10",
      "modus": "sammenstill_sluttfaktura",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_batch_output",
      "filnavn": "sluttfaktura",
      "batch": "pa_fak_ba_10",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "sammenstill_sluttfaktura/${termin}"
    },
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_10",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },


    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_04",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "sluttfaktura",
      "batchFra": "pa_fak_ba_10",
      "batchTil": "pa_fak_ba_04",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "sammenstill_sluttfaktura/${termin}"
    },
    {
      "handling": "pa_fak_ba_04",
      "modus": "generer_fakturaunderlag_hbf_fls_for_sluttfaktura",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "termin": "${termin}",
      "premiemodell": "HBF_FLS",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_batch_output",
      "filnavn": "fakturaunderlag",
      "batch": "pa_fak_ba_04",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "generer_fakturaunderlag_hbf_fls_for_sluttfaktura/${termin}"
    },
    {
      "handling": "pa_fak_ba_04",
      "modus": "generer_agressofil_hbf_fls_for_sluttfaktura",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "termin": "${termin}",
      "premiemodell": "HBF_FLS",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_batch_output",
      "filnavn": "agressofil_hbf_fls_sluttfaktura",
      "batch": "pa_fak_ba_04",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "generer_agressofil_hbf_fls_for_sluttfaktura/${termin}",
      "filter": "Agressofil,Feiltype"
    },
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_04",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },


    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "sluttfaktura",
      "batchFra": "pa_fak_ba_10",
      "batchTil": "pa_fak_ba_09",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "sammenstill_sluttfaktura/${termin}"
    },
    {
      "handling": "kopier_filer_fra_aktuar_til_batch",
      "premiemodell": "hbf_fls",
      "prognoseVersjon": "${oppgjørsVersjon}",
      "periode": "${termin}",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "kommentar" : "kopierer oppgjoersfil"
    },
    {
      "handling": "pa_fak_ba_09",
      "modus": "sluttfaktura_dataunderlag_for_medlem",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "kjøringsId": "#{genererUUID}",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_batch_output",
      "filnavn": "sluttfaktura_dataunderlag_medlem",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "sluttfaktura_dataunderlag_for_medlem/${termin}"
    },
    {
      "handling": "send_batch_output_til_dvh",
      "filPrefix": "sluttfaktura_dataunderlag_medlem",
      "filListe": "HBFFLS_FILLISTE_MEDLEM.txt",
      "batch": "pa_fak_ba_09",
      "filstiHosDVH": "/hbf_fls/sluttfaktura/medlem"
    },


    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    },
    {
      "handling": "konkatiner_og_kopier_fra_arkiv_til_batch",
      "filnavn": "sluttfaktura_dataunderlag_medlem",
      "batchFra": "pa_fak_ba_09",
      "batchTil": "pa_fak_ba_09",
      "grunnlagsdataMappeTil":"${grunnlagsdataMappe}",
      "nøkkel": "sluttfaktura_dataunderlag_for_medlem/${termin}"
    },
    {
      "handling": "pa_fak_ba_09",
      "modus": "sluttfaktura_dataunderlag_for_avtale",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "kjøringsId": "#{genererUUID}",
      "validerFeilendeMedlemmer": true
    },
    {
      "handling": "arkiver_batch_output",
      "filnavn": "sluttfaktura_dataunderlag_avtale",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}",
      "nøkkel": "sluttfaktura_dataunderlag_for_avtale/${termin}"
    },
    {
      "handling": "send_batch_output_til_dvh",
      "filPrefix": "sluttfaktura_dataunderlag_avtale",
      "filListe": "HBFFLS_FILLISTE_AVTALE.txt",
      "batch": "pa_fak_ba_09",
      "filstiHosDVH": "/hbf_fls/sluttfaktura/avtale"
    },
    {
      "handling": "rydd_grunnlagsdata_for_batch",
      "batch": "pa_fak_ba_09",
      "grunnlagsdataMappe": "${grunnlagsdataMappe}"
    }
  ]
}
